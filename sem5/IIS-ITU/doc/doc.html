<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu
     podle pou¾itého editoru -->

<h1>Informaèní systém pro florbalovou ligu (vlastní zadání)</h1> <!-- Nahradte názvem svého zadání -->

<dl>
	<dt>Autoøi</dt>
	<dd>Vladimír Du¹ek <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xdusek27@stud.fit.vutbr.cz">xdusek27@stud.fit.vutbr.cz</a>
        <ul>
            <li> Django Models </li>
            <li> Django Views a pøíslu¹né HTML ¹ablony pro stránky: O nás, Rozpis, Výsledky, Tabulka </li>
            <li> Vytvoøení testovacích dat </li>
            <li> Administrátorské rozhraní </li>
        </ul>
    </dd>
	<dd>Tomá¹ Kukaò <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xkukan00@stud.fit.vutbr.cz">xkukan00@stud.fit.vutbr.cz</a>
        <ul>
            <li> Django Views a pøíslu¹né HTML ¹ablony pro stránky: Play-off, Statistiky, Týmy </li>
            <li> Pøepínání sezón </li>
            <li> Registrace a pøihlá¹ení u¾ivatele </li>
        </ul>
	</dd>
	<dt>URL aplikace</dt>
	<dd><a href="http://89.221.215.52">http://89.221.215.52</a></dd>
</dl>

<h2>Popis zadání</h2>
<p>Jedná se o informaèní systém pro správu florbalové ligy. Sezóna trvá standardnì jeden rok.
Sezóna je rozdìlena na dvì èásti, základní a vyøazovací èást (play-off). Uva¾ujeme, ¾e
ligu hraje více jak 8 týmù. V základní èásti se proti sobì utká ka¾dý tým 2x (doma, venku).
Do vyøazovací èásti postupuje 8 nejlep¹ích týmù. Zápasy se hrají v kolech. Kolem mù¾eme
rozumnìt jeden hrací víkend, bìhem kterého tým mù¾e odehrát i více zápasù. U¾ivatelùm
bude k dispozici stránka s rozpisem zápasù, kdy, v kolik a kdo proti sobì nastoupí. Dále
stránka s výsledky, kde budou zaznamenávány odehrané zápasy, jejich výsledky, støelci gólù
a trestaní hráèi. Trest mù¾e být udìlen dvou nebo pìtiminutový. Dále bude k dispozici stránka
s tabulkou a prùbì¾ným poøadím. Zde bude uvedeno jak si týmy vedou, kolik odehráli zápasù,
kolikrát prohráli, vyhráli, remizovali, kolik vstøelili a obdr¾eli gólù a jejich bodový zisk.
Dal¹í bude stránka pro vyøazovací èást, kde bude stránka s pavoukem pro play-off. Dále stránka se statistikama
hráèù, zde budou informace o kanadském bodování, odehraných zápasù a obdr¾ených tresných minut hráèù.
Poslední bude stránka týmù, kde bude pøehled týmù kteøí hrajou danou sezónu a soupisky hráèù.
Ve¹keré tyto informace bude mo¾né zobrazit a» u¾ pro aktuální sezónu, tak sezóny uplynulé. Hráè mù¾e po ukonèení
sezóny mìnit tým. Hráèi a týmy mohou samozøejmì hrát rùzný poèet sezón. U¾ivatel se mù¾e zaregistrovat.
Registrovaný u¾ivatel má práva pro vytvoøení týmu, sepsání soupisky hráèù a informací o nich. Následnì
mù¾e zaregistrovat svùj tým pro nadcházející sezónu. Administrátor mù¾e vytvoøit novou sezónu, vkládat
zápasy, zadávat výsledky zápasù, støelce gólù a trestané hráèe. </p>

<h2>U¾ivatelé systému pro testování</h2>
<p>Existující zástupci v¹ech rolí (po inicializaci testovacími daty)</p>
<table>
    <tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
    <tr><td>admin</td><td>admin</td><td>Správce soutì¾e (Administrátor)</td></tr>
    <tr><td>Leader</td><td>123456789</td><td>Kapitán týmu Èermáci (Registrovaný u¾ivatel)</td></tr>
    <tr><td></td><td></td><td>Hráè, fanou¹ek (Bì¾ný u¾ivatel)</td></tr>
</table>
<p>Administrátor je správce soutì¾e. Mù¾e tedy spravovat organizaèní vìci. To znamená,
vytváøet nové sezóny, kola, zápasy, zadávat výsledky zápasù, tresty a podobnì. Zároveò
má právo cokoliv smazat. <b>Administrátorského rozhraní je dostupné na
<code>/admin</code>.</b></p>

<p>Pøihlá¹ený u¾ivatel pak mù¾e vytváøet týmy,
vytváøet hráèe, registrovat hráèe do týmu a registrovat tým do sezóny. <b>Rozhraní
pøihlá¹eného u¾ivatele je dostupné tlaèítky v pravém horním rohu v hlavièce. Pøípadnì
na URL <code>registrace-tymu/</code></b>.</p>

<p>Nepøihlá¹ený u¾ivatel mù¾e pouze konzumovat obsah informaèního systému. Sledovat
rozpis ligy, výsledky, tabulku, ... Mù¾e se zaregistrovat a stát se tak registrovaným
u¾ivatelem.</p>

<h2>Implementace</h2>
<p>
    Pro implementaci jsme zvolili Python web framework Django s databázi PostgreSQL. Bylo tøeba
    nainstalovat Python balíèky django a psycopg2 a linuxové balíèky postgresql-server a
    postgresql-contrib. Django je pomìrnì vysokoúrovòový framework, dotazy do databáze lze
    psát pøímo v Pythonu, které si Django spracuje do SQL. Tabulky databáze jsou
    definovány pomocí Modelù (Models), opìt není nutné ¾ádné SQL. Ve Views jsou pak
    provádìny dotazy do databáze a serializace dat. Django má také vlastní HTML ¹ablonovací
    systém pro dynamickou tvorbu stránek. Jako frontendové technologie jsme zvolili HTML, CSS
    s frameworkem Bootstrap a Javascript knihovnu JQuery.
</p>

<h2>Instalace</h2>

<h3>Instalace potøebného software (OS Fedora)</h3>
<ul>
    <li>Interpret pythonu ve verzi 3.6, pøípadnì novìj¹í
        <ul>
            <code># dnf install python3</code>
        </ul>
    </li>
    <li>Databáze Postgresql balíèky
        <ul>
            <code># dnf install postgresql-server</code><br>
            <code># dnf install postgresql-contrib</code>
        </ul>
    </li>
    <li>Python framework Django ve verzi 2.1, pøípadnì novìj¹í
        <ul>
            <code># pip install django</code>
        </ul>
    </li>
    <li>Python balíèek psycobp2
        <ul>
            <code># pip install psycopg2</code>
        </ul>
    </li>
    <li>Python balíèek gunicorn
        <ul>
            <code># pip install gunicorn</code>
        </ul>
    </li>
</ul>

<h3>Konfigurace</h3>
<ul>
    <li>Spu¹tìní databázového serveru Postgresql
        <ul>
            <code># systemctl start postgresql</code>
        </ul>
    </li>
    <li>Inicializace databáze
        <ul>
            <code># postgresql-setup --initdb --unit postgresql</code>
        </ul>
    </li>
    <li>Spravování databáze pøes psql
        <ul>
            <code>$ psql -d postgres -U postgres</code>
        </ul>
    </li>
</ul>

<h3>Spravování informaèního systému</h3>
<ul>
    <li>Vygenerování migrací
        <ul>
            <code>$ python manage.py makemigrations</code>
        </ul>
    </li>
    <li>Spu¹tìní migrací
        <ul>
            <code>$ python manage.py migrate</code>
        </ul>
    </li>
    <li>Naplnìní databáze testovacími daty
        <ul>
            <code>$ python manage.py fill_db</code>
        </ul>
    </li>
    <li>Vyèi¹tìní databáze
        <ul>
            <code>$ python manage.py clean_db</code>
        </ul>
    </li>
    <li>Spu¹tìní serveru
        <ul>
            <code>$ python manage.py runserver</code>
        </ul>
    </li>
</ul>

<h3>Spu¹tení serveru</h3>
<ul>
    <li>Konfigurace nginx dle pøilo¾eného configuraèního souboru
        <ul>
            <code>nginx/nginx.conf</code>
        </ul>
    </li>
    <li>Spu¹tìní nginx deamona
        <ul>
            <code>$ systemctl start nginx.service</code>
        </ul>
    </li>
    <li>Spu¹tìní pøilo¾eného deploy skriptu
        <ul>
            <code>nginx/deploy.sh</code>
        </ul>
    </li>
</ul>

<h2>Známé problémy</h2>
<p>
    Registrovaný u¾ivatel nemù¾e smazat sebou vytvoøený tým, nebo sebou
    vytvoøené hráèe. Tato mo¾nost by mìla být k dispozici pøed zahájením sezóny,
    do které je tým registrován. Toto jsme ji¾ nestihli implementovat z èasových
    dùvodù.
</p>
<p>
    Pøi správì IS administrátorem, nìkde chybí validace vlo¾ených dat. Napøíklad pøi vkládání
    výsledkù zápasu, lze urèit støelcem gólù i hráèe, který daný zápas vùbec nehrál. Stejnì tak
    tým, který gól vstøelil, lze oznaèit tým, který daný zápas vùbec nehrál. Stejná situace pøi
    zadávání trestù hráèùm. Èasu vstøelených gólù a udìlených trestù, jestli nejsou mimo hrací dobu.
</p>

</body>
</html>
